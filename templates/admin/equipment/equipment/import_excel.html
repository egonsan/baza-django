{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<h1>Import / Eksport kart sprzętu</h1>

<p>
    Ta strona pozwala na:
</p>

<ul>
    <li>import kart sprzętu z pliku Excel (XLSX),</li>
    <li>eksport kart sprzętu do Excela,</li>
    <li>import danych oprogramowania (zakładka „Oprogramowanie”).</li>
</ul>

<hr>

<h2>Import kart sprzętu z pliku Excel (XLSX)</h2>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <fieldset class="module aligned">
        <div class="form-row">
            <label for="id_file"><strong>Plik XLSX:</strong></label>
            <input type="file" name="file" id="id_file" required>
        </div>
    </fieldset>

    <div class="submit-row">
        <input type="submit" value="Importuj karty sprzętu" class="default">
    </div>
</form>

{% if import_done %}
    <h3>Wynik importu kart sprzętu</h3>
    <ul>
        <li>Przetworzone niepuste wiersze: {{ processed_rows }}</li>
        <li>Utworzone nowe karty: {{ created_count }}</li>
        <li>Zaktualizowane istniejące karty: {{ updated_count }}</li>
    </ul>
{% endif %}

<hr>

<h2>Eksport kart sprzętu do Excela</h2>

<p>
    <a href="{% url 'equipment:equipment_export' %}" class="default">
        Eksportuj karty sprzętu do Excela
    </a>
</p>

<hr>

<h2>Import danych do zakładki „Oprogramowanie”</h2>

<p>
    Importuje dane z arkusza <strong>„Zmienne programy”</strong>  
    i <strong>całkowicie nadpisuje</strong> stan oprogramowania w bazie.
</p>

<p>
    <a href="{% url 'educational_software:software_import' %}" class="default">
        Importuj oprogramowanie z Excela
    </a>
</p>

{% endblock %}
