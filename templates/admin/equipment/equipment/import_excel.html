{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<h1>Import / Eksport kart sprzętu</h1>

<p>
    Ta strona pozwala na zaimportowanie kart sprzętu z pliku Excel (XLSX)
    oraz na wyeksportowanie aktualnych danych z bazy do Excela w tym samym formacie.
</p>

<hr>

<h2>Import z pliku Excel (XLSX)</h2>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <fieldset class="module aligned">
        <div class="form-row">
            <label for="id_file"><strong>Plik XLSX:</strong></label>
            <input type="file" name="file" id="id_file" required>
        </div>
    </fieldset>

    <div class="submit-row">
        <input type="submit" value="Importuj" class="default">
    </div>
</form>

{% if import_done %}
    <h3>Wynik importu</h3>
    <ul>
        <li>Przetworzone niepuste wiersze: {{ processed_rows }}</li>
        <li>Utworzone nowe karty: {{ created_count }}</li>
        <li>Zaktualizowane istniejące karty: {{ updated_count }}</li>
    </ul>
{% endif %}

<hr>

<h2>Eksport danych do Excel</h2>

<p>
    Możesz pobrać wszystkie karty sprzętu w formie pliku XLSX zgodnego ze strukturą importu.
</p>

<p>
    <a href="{% url 'equipment:equipment_export' %}" class="default">
        Eksportuj dane do Excela
    </a>
</p>

{% endblock %}