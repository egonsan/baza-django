{% load static %}
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="utf-8">
    <title>WIMiO</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Ustawiamy motyw PRZED renderem (bez “mignięcia”) -->
    <script>
      (function () {
        try {
          var t = localStorage.getItem("theme");
          if (t === "dark" || t === "light") {
            document.documentElement.setAttribute("data-theme", t);
          } else {
            document.documentElement.setAttribute("data-theme", "light");
          }
        } catch (e) {
          document.documentElement.setAttribute("data-theme", "light");
        }
      })();
    </script>

    <!-- Globalny CSS UI -->
    <link rel="stylesheet" href="{% static 'sprzet/ui.css' %}">
</head>
<body>

{% include "sprzet/header.html" %}

<div id="{% if request.resolver_match.url_name in 'login login-root' %}login-bg{% else %}main-bg{% endif %}">
    {% block content %}{% endblock %}
</div>

<script>
  (function () {
    function getTheme() {
      try {
        var t = localStorage.getItem("theme");
        return (t === "dark" || t === "light") ? t : "light";
      } catch (e) {
        return "light";
      }
    }

    function setTheme(theme) {
      document.documentElement.setAttribute("data-theme", theme);
      try { localStorage.setItem("theme", theme); } catch (e) {}
    }

    document.addEventListener("DOMContentLoaded", function () {
      var btn = document.getElementById("themeToggle");
      if (!btn) return;

      btn.addEventListener("click", function () {
        var current = document.documentElement.getAttribute("data-theme") || getTheme();
        var next = (current === "dark") ? "light" : "dark";
        setTheme(next);
      });
    });
  })();
</script>

</body>
</html>