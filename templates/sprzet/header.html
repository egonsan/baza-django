{% load static %}

<style>
    /* HEADER z mocniejszym gradientem poziomym LEFT → RIGHT */
    .top-nav {
        position: sticky;
        top: 0;
        z-index: 1000;

        background: linear-gradient(
            90deg,
            #08101d 0%,
            #152234 50%,
            #233247 100%
        );

        border-bottom: 1px solid rgba(255,255,255,0.08);
        box-shadow: 0 6px 22px rgba(0,0,0,0.45);
    }

    .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 10px 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 24px;
    }

    /* LEWA STRONA – logo + tytuł */
    .nav-left {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .nav-logo-img {
        width: 34px;
        height: 34px;
        border-radius: 6px;
        object-fit: contain;
    }

    .nav-logo-title {
        font-size: 1.10em;
        font-weight: 600;
        color: #ffffff;
        letter-spacing: 0.5px;
    }

    /* PRAWY BLOK – linki + użytkownik */
    .nav-right {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        flex: 1;
        gap: 24px;
    }

    /* LINKI */
    .nav-links {
        display: flex;
        gap: 26px;
        align-items: center;
        margin-right: 36px;
    }

    .nav-link {
        color: #d4dbee;
        text-decoration: none;
        font-size: 0.97em;
        font-weight: 500;
        padding: 4px 2px;
        transition: color 0.15s ease, font-weight 0.15s ease;
    }

    .nav-link:hover {
        color: #ffffff;
    }

    .nav-link-active {
        color: #ffffff !important;
        font-weight: 700 !important;
    }

    .nav-link-disabled {
        color: rgba(255,255,255,0.38);
        cursor: default;
        pointer-events: none;
    }

    /* UŻYTKOWNIK */
    .nav-user {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.88em;
        color: #e5e7eb;
        white-space: nowrap;
    }

    .nav-user-name {
        opacity: 0.9;
    }

    .nav-user-logout {
        display: inline-flex;
        align-items: center;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid rgba(248,250,252,0.6);
        font-size: 0.82em;
        font-weight: 500;
        text-decoration: none;
        color: #f9fafb;
        background: transparent;
        transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
    }

    .nav-user-logout:hover {
        background: #f9fafb;
        color: #111827;
        border-color: #f9fafb;
    }

    /* ===== THEME TOGGLE ===== */

    .theme-toggle-wrap {
        margin-left: 18px;
        display: inline-flex;
        align-items: center;
    }

    .theme-toggle {
        background: none;
        border: none;
        padding: 4px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        line-height: 0;
    }

    /* Lokalna paleta tylko dla ikon */
    :root{
        --toggle-sun: rgba(220,225,235,0.95);   /* JAŚNIEJSZE słońce */
        --toggle-moon: var(--muted);             /* księżyc bez zmian */
    }

    .theme-toggle svg {
        width: 16px;
        height: 16px;
        fill: none;
        stroke-width: 2;
        opacity: 0.95;
        transition: opacity 0.15s ease;
    }

    .theme-toggle:hover svg {
        opacity: 1;
    }

    /* Słońce */
    .theme-toggle .icon-sun {
        stroke: var(--toggle-sun);
    }

    /* Księżyc */
    .theme-toggle .icon-moon {
        display: none;
        fill: var(--toggle-moon);
        stroke: none;
    }

    html[data-theme="dark"] .theme-toggle .icon-sun { display: none; }
    html[data-theme="dark"] .theme-toggle .icon-moon { display: block; }

</style>

<header class="top-nav">
    <div class="nav-container">

        <div class="nav-left">
            <img src="{% static 'sprzet/logo1.png' %}" class="nav-logo-img" alt="Logo">
            <div class="nav-logo-title">WIMiO</div>
        </div>

        <div class="nav-right">
            {% with current_url=request.resolver_match.url_name %}

            <nav class="nav-links">
                <a href="{% url 'educational_software:software_list' %}"
                   class="nav-link {% if current_url == 'software_list' or current_url == 'software_detail' or current_url == 'laboratory_detail' %}nav-link-active{% endif %}">
                    Oprogramowanie
                </a>

                {% if user.is_authenticated and not request.session.guest %}
                    <a href="{% url 'equipment:rooms_dashboard' %}"
                       class="nav-link {% if current_url == 'rooms_dashboard' or current_url == 'rooms_category_detail' or current_url == 'room_equipment_list' %}nav-link-active{% endif %}">
                        Pomieszczenia / Sale
                    </a>

                    <a href="{% url 'equipment:workers_list' %}"
                       class="nav-link {% if current_url == 'workers_list' or current_url == 'worker_detail' %}nav-link-active{% endif %}">
                        Pracownik
                    </a>

                    <a href="{% url 'equipment:equipment_list' %}"
                       class="nav-link {% if current_url == 'equipment_list' or current_url == 'equipment_detail' or current_url == 'equipment_edit' %}nav-link-active{% endif %}">
                        Magazyn
                    </a>
                {% endif %}
            </nav>

            {% endwith %}

            <div class="nav-user">
                <span class="nav-user-name">
                    Zalogowany:
                    {% if request.session.guest %}
                        Gość
                    {% elif user.is_authenticated %}
                        {{ user.get_full_name|default:user.username }}
                    {% else %}
                        brak
                    {% endif %}
                </span>

                {% if user.is_authenticated or request.session.guest %}
                    <a href="{% url 'logout' %}" class="nav-user-logout">
                        Wyloguj
                    </a>

                    <span class="theme-toggle-wrap">
                        <button class="theme-toggle" id="themeToggle" title="Zmień motyw" type="button">
                            <!-- SUN -->
                            <svg class="icon-sun" viewBox="0 0 24 24" aria-hidden="true">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                            </svg>

                            <!-- MOON -->
                            <svg class="icon-moon" viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3
                                         7 7 0 0 0 21 12.79z"></path>
                            </svg>
                        </button>
                    </span>
                {% endif %}
            </div>

        </div>
    </div>
</header>