{% extends "sprzet/base.html" %}
{% block content %}

<div class="ui-panel panel">
  <div class="panel-header" style="display:flex; justify-content:space-between; gap:16px; flex-wrap:wrap;">
    <div>
      <h1 class="panel-title">Magazyn</h1>
      <p class="panel-subtitle">
        Lista sprzętu z kategorią <strong>MAGAZYN</strong>.
        Możesz filtrować po numerze inwentarzowym, nazwie, użytkowniku, budynku lub pomieszczeniu.
      </p>
    </div>

    <form method="get" class="ui-actions">
      <input
        type="search"
        name="q"
        value="{{ request.GET.q }}"
        placeholder="Szukaj…"
        style="min-width:220px;"
      >
      <button type="submit" class="ui-btn ui-btn-primary">Szukaj</button>
    </form>
  </div>

  {% if equipments %}
    <table class="ui-table">
      <thead>
        <tr>
          <th>Nr inwentarzowy</th>
          <th>Nazwa</th>
          <th>Użytkownik</th>
          <th>Budynek</th>
          <th>Pomieszczenie</th>
          <th>Status</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for eq in equipments %}
          <tr>
            <td><strong>{{ eq.inventory_number }}</strong></td>
            <td>{{ eq.equipment_name }}</td>
            <td>{{ eq.user_full_name }}</td>
            <td>{{ eq.building }}</td>
            <td>{{ eq.room }}</td>
            <td>{{ eq.status }}</td>
            <td style="text-align:right; white-space:nowrap;">
              <a href="{% url 'equipment:equipment_detail' eq.pk %}" class="ui-btn ui-btn-secondary">
                Szczegóły
              </a>
              <a href="{% url 'equipment:equipment_edit' eq.pk %}" class="ui-btn ui-btn-primary">
                Edytuj
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    {% if is_paginated %}
      <div class="ui-actions" style="margin-top:16px; justify-content:flex-end;">
        {% if page_obj.has_previous %}
          <a class="ui-btn ui-btn-secondary"
             href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
            ← Poprzednia
          </a>
        {% endif %}

        <span class="muted">
          Strona {{ page_obj.number }} z {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
          <a class="ui-btn ui-btn-secondary"
             href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
            Następna →
          </a>
        {% endif %}
      </div>
    {% endif %}
  {% else %}
    <p class="empty">Brak sprzętu w magazynie.</p>
  {% endif %}
</div>

{% endblock %}